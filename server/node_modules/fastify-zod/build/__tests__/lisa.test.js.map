{"version":3,"file":"lisa.test.js","names":["test","originalSpec","JSON","parse","readFile","join","__dirname","encoding","t","SpecTransformer","$ref","key","result","transform","mergeRefs","schemaKeys","removeInitialSchemasPrefix","changeCase","writeFile","stringify","transformedSpec","expect","toEqual"],"sources":["../../src/__tests__/lisa.test.ts"],"sourcesContent":["import { readFile, writeFile } from \"fs/promises\";\nimport { join } from \"path\";\n\nimport { SpecTransformer } from \"../SpecTransformer\";\n\ntest(`lisa`, async () => {\n  const originalSpec = JSON.parse(\n    await readFile(\n      join(\n        __dirname,\n        `..`,\n        `..`,\n        `src`,\n        `__tests__`,\n        `lisa.openapi.original.fixtures.json`,\n      ),\n      {\n        encoding: `utf-8`,\n      },\n    ),\n  );\n  const t = new SpecTransformer(originalSpec);\n\n  const $ref = (key: string) =>\n    ({\n      $ref: `T#/properties/${key}`,\n    } as const);\n\n  const result = t.transform({\n    mergeRefs: [\n      $ref(`JsonRecord`),\n      $ref(`Uuid`),\n      $ref(`Email`),\n      $ref(`UserEmail`),\n      $ref(`GroupRole`),\n      $ref(`ParticipantRole`),\n      $ref(`ParticipantId`),\n      $ref(`ParticipantGroupId`),\n      $ref(`UserParticipantRelationship`),\n    ],\n    schemaKeys: {\n      removeInitialSchemasPrefix: true,\n      changeCase: `PascalCase`,\n    },\n  });\n\n  await writeFile(\n    join(\n      __dirname,\n      `..`,\n      `..`,\n      `src`,\n      `__tests__`,\n      `lisa.openapi.transformed.fixtures.json`,\n    ),\n    JSON.stringify(result, null, 2),\n    { encoding: `utf-8` },\n  );\n\n  const transformedSpec = JSON.parse(\n    await readFile(\n      join(\n        __dirname,\n        `..`,\n        `..`,\n        `src`,\n        `__tests__`,\n        `lisa.openapi.transformed.fixtures.json`,\n      ),\n      { encoding: `utf-8` },\n    ),\n  );\n\n  expect(result).toEqual(transformedSpec);\n});\n"],"mappings":";;AAAA;;AACA;;AAEA;;AAEAA,IAAI,CAAE,MAAF,EAAS,YAAY;EACvB,MAAMC,YAAY,GAAGC,IAAI,CAACC,KAAL,CACnB,MAAM,IAAAC,kBAAA,EACJ,IAAAC,UAAA,EACEC,SADF,EAEG,IAFH,EAGG,IAHH,EAIG,KAJH,EAKG,WALH,EAMG,qCANH,CADI,EASJ;IACEC,QAAQ,EAAG;EADb,CATI,CADa,CAArB;EAeA,MAAMC,CAAC,GAAG,IAAIC,gCAAJ,CAAoBR,YAApB,CAAV;;EAEA,MAAMS,IAAI,GAAIC,GAAD,KACV;IACCD,IAAI,EAAG,iBAAgBC,GAAI;EAD5B,CADU,CAAb;;EAKA,MAAMC,MAAM,GAAGJ,CAAC,CAACK,SAAF,CAAY;IACzBC,SAAS,EAAE,CACTJ,IAAI,CAAE,YAAF,CADK,EAETA,IAAI,CAAE,MAAF,CAFK,EAGTA,IAAI,CAAE,OAAF,CAHK,EAITA,IAAI,CAAE,WAAF,CAJK,EAKTA,IAAI,CAAE,WAAF,CALK,EAMTA,IAAI,CAAE,iBAAF,CANK,EAOTA,IAAI,CAAE,eAAF,CAPK,EAQTA,IAAI,CAAE,oBAAF,CARK,EASTA,IAAI,CAAE,6BAAF,CATK,CADc;IAYzBK,UAAU,EAAE;MACVC,0BAA0B,EAAE,IADlB;MAEVC,UAAU,EAAG;IAFH;EAZa,CAAZ,CAAf;EAkBA,MAAM,IAAAC,mBAAA,EACJ,IAAAb,UAAA,EACEC,SADF,EAEG,IAFH,EAGG,IAHH,EAIG,KAJH,EAKG,WALH,EAMG,wCANH,CADI,EASJJ,IAAI,CAACiB,SAAL,CAAeP,MAAf,EAAuB,IAAvB,EAA6B,CAA7B,CATI,EAUJ;IAAEL,QAAQ,EAAG;EAAb,CAVI,CAAN;EAaA,MAAMa,eAAe,GAAGlB,IAAI,CAACC,KAAL,CACtB,MAAM,IAAAC,kBAAA,EACJ,IAAAC,UAAA,EACEC,SADF,EAEG,IAFH,EAGG,IAHH,EAIG,KAJH,EAKG,WALH,EAMG,wCANH,CADI,EASJ;IAAEC,QAAQ,EAAG;EAAb,CATI,CADgB,CAAxB;EAcAc,MAAM,CAACT,MAAD,CAAN,CAAeU,OAAf,CAAuBF,eAAvB;AACD,CArEG,CAAJ"}